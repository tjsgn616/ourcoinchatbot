# 개요
- 코인114는 시세 조회, 지정한 시점과의 코인 비교 기능을 제공하고, 실시간 top5 코인 정보와 뉴스, 영상을 통해 코인 동향 까지 파악할 수 있는 카카오톡 챗봇입니다.
- 필요한 library들을 requirements.txt에 입력해 주어야 정상적으로 작동합니다.

# main.py
## marketData()
- request와 업비트 API를 이용하여 market(가상화폐코드),KoreanName,EnglishName 정보를 불러옵니다.
- 기준화폐에 따라 KRW, BTC, USDT로 분류한 currency 항을 추가하여 하나의 namedata를 만듭니다.
- 후에 쓰기 위해 가상화폐 영어 명칭의 대소문자 통합 및 공백 처리를 하여 일정한 형태로 통일 시킵니다.
## now()
- 현재 시세를 조회합니다. 인지도가 높고 대표적인 가상 화폐들을 보여줍니다.
- 아래의 '더 많은 코인 조회'를 누를 시, /more이 있는 블록으로 이동합니다.
## more()
- 입력한 가상화폐의 현재 시세를 조회 할 수 있습니다. 입력한 화폐 이름은 챗봇 관리자 기능을 통해 파라미터 값으로 입력됩니다.입력된 가상화폐 이름을 namedata 속 정보와 대조하여 일치하는 값을 가져옵니다.(어떤 형태의 코인을 입력하던지 한국 명칭으로 출력합니다.)
- 일치하는 값이 없다면 오류가 발생하였다는 알림을 띄우고 돌아가는 블럭을 지정하여 동일한 과정을 다시 진행 할 수 있습니다.
- 연속된 발화 값을 파라미터로 저장하는 것(KRW, USDT, BTC 선택)에 어려움이 있어 모든 결과 값을 kRW값으로 계산하여 출력하도록 했습니다.(아래의 다른 함수에서 되묻기 질문을 통해 해결 하였습니다.)
## acc()
- 정각 기준 실시간 가격 변동량 TOP 5,전일 대비 실시간 가격 변동량 TOP 5를 확인 할 수 있습니다.
- 데이터베이스에 저장된 값을 불러와서 출력합니다.
- 리스트 카드는 상세 정보를 볼 수 있는 블록인 /sang 과 연결 되어있습니다.
## sang()
- 리스트 카드를 클릭하면 해당 코인의 정보를 불러옵니다.
- 업비트 API에서 해당 코인 market 조회를 합니다.
- 해당 코인의 실시간 상세 정보를 보여줍니다.
- KRW 코인이면 그대로 보여주고 그 외 코인이면 KRW로 환산하여 출력합니다.
- 뉴스 보러 가기를 클릭하면  /searchnews로 연결 됩니다.
- 업비트를 클릭하면 해당 코인의 업비트 사이트로 연결 됩니다.
## hopepirce()
- 희망 매도가를 계산합니다.
- 되묻기 질문을 통해 연속된 발화 입력값을 저장 할 수 있습니다.
- 화폐 이름, 사용자의 구매한 평균가격, 사용자가 희망하는 이득률을 입력하면 해당 이득률 일 때의 화폐의 가격과 현재와의 차이를 보여줍니다.
- 잘못된 값을 입력하였을 때, 오류 창을 출력하고 같은 부분부터 다시 진행할 수 있도록 하였습니다.
## seejum()
- 특정 가상 화폐를 입력한 시점과 비교하여 변동률을 현재 시점의 변동률을 출력합니다.
- 입력값은 가상 화폐 이름과 비교하고 싶은 시점에 대한 시간 정보입니다.
- 필요한 연속 발화 값은 되묻기 질문을 통해 동시에 파라미터로 받아옵니다.
## searchnews()
- 네이버 뉴스에서 입력값으로 받아온 특정 가상화폐로 검색한 결과를 크롤링합니다.(제목, 썸네일, URL링크)
- 이전 clientExtra 파라미터로 저장해 놓은 값을 입력값으로 받아옵니다.
## basic()
- 위의 searchnews()와 동일하지만, query에 입력한 미리 입력된 검색어에 대한 결과를 크롤링하게 돼있습니다.
- 단순한 한가지의 검색어 결과로는 부족하다고 판단되어, 비트코인,가상화폐,가상자산,이더리움 4개 모두의 검색 결과 중 연관성이 높은 것 5개를 출력하도록 하였다.
- 기존 urllib을 이용할 때, urllib은 유니코드문자를 받아오지 못하기 때문에 url형식으로 바꿔주는 urllib의 quote함수를 사용하였습니다.
- 최적화 하는 과정에서 urllib을 제외하고 beautifulsoup와 requests 만으로 진행했기 때문에 quote가 필수이지 않게 됐습니다.
## youtube()
- 유튜브의 가상화폐 관련 영상의 제목과 썸네일을 크롤링해옵니다.
- youtube api를 이용하여 정보를 가져오며, 그 과정에서 googleapiclient와 oauth2client 라이브러리를 사용하였습니다.
- pip install --upgrade google_api_python_client
- pip install oauth2client
- 네이버 검색과 다르게 동시에 검색하는 기능이 없고, 개별로 검색했을 때 가장 유의미한 검색 결과를 출력하는 검색어가 비트코인 이라고 판단되어 비트코인 에 대한 검색 결과를 출력하도록 하였습니다.
- 
# topfive.py
## top()
- market 이름과 market 코드가 저장되어 있는 market_list.csv파일을 불러옵니다.
- request와 업비트 API를 이용하여 candle과 현재 ticker 조회를 불러와서 저장합니다.
### 전일 대비 실시간 탑 5
- 변동률 탑 5를 구하기 위해 change_rate키 값으로 내림차순 정렬합니다.
- change 값을 상승,하락,보합으로 변경하여 저장합니다.
### 1시간 간격 실시간 탑 5
- 1시간 candle 값과 현재 값을 비교하여 변동률을 구합니다.
- 변동률을 기준 내림차순으로 정렬후 상위 5개를 추출하여 저장합니다.
## liveData()
- postgresql DB에 접속합니다. 
- top()에서 추출한 데이터를 데이터베이스에 저장합니다.
# wsgi.py
## 서버 실행
- 해당 파일 내용에 포함된 파일을 서버에서 실행 하도록 해주는 파일입니다.


# deploy.sh

- 배포하는 과정을 요약하기 위해 deploy.sh를 만들 수 있습니다.
- deploy.sh 파일을 만들고, 메모장으로 배포 코드를 입력해 놓습니다.
  - deploy.sh 에는 아래 내용이 포함돼 있습니다.
  - git add .
  - git commit -am "updated"
  - git push heroku master

# requirements.txt
- 코드에서 사용한 library들을 모두 기록해 놓습니다.

# runtime.txt
- 구동할 python 버전을 기록해 놓습니다.
